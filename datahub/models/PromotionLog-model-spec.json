{
  "modelName": "PromotionLog",
  "rootElement": "PromotionLog",
  "description": "Audit log for each promotion run. Tracks metadata, status, and detailed results for every component promotion from dev to test or production environments. Supports 3 deployment paths: Dev→Test (automated validation, no manual gates), Test→Production (with review), and emergency hotfix Dev→Production (with review). Provides compliance trail and debugging information.",
  "fields": [
    {
      "name": "promotionId",
      "type": "String",
      "description": "UUID uniquely identifying this promotion run",
      "required": true,
      "matchField": true
    },
    {
      "name": "devAccountId",
      "type": "String",
      "description": "Source dev sub-account ID",
      "required": true,
      "matchField": false
    },
    {
      "name": "prodAccountId",
      "type": "String",
      "description": "Target production account ID",
      "required": true,
      "matchField": false
    },
    {
      "name": "devPackageId",
      "type": "String",
      "description": "PackagedComponent packageId from dev account used for promotion",
      "required": true,
      "matchField": false
    },
    {
      "name": "prodPackageId",
      "type": "String",
      "description": "PackagedComponent packageId created in production account during packaging step",
      "required": false,
      "matchField": false
    },
    {
      "name": "initiatedBy",
      "type": "String",
      "description": "SSO user email who initiated the promotion",
      "required": true,
      "matchField": false
    },
    {
      "name": "initiatedAt",
      "type": "Date",
      "description": "Timestamp when promotion started (format: yyyy-MM-dd'T'HH:mm:ss.SSS'Z')",
      "required": true,
      "matchField": false
    },
    {
      "name": "status",
      "type": "String",
      "description": "Current promotion status. Process C writes COMPLETED (all components promoted successfully) or FAILED (any component failed — branch deleted). Intermediate statuses (PENDING_PEER_REVIEW, PENDING_ADMIN_APPROVAL, TEST_DEPLOYED) are set by downstream processes. PARTIALLY_COMPLETED is NOT a valid status — the fail-fast policy ensures binary outcomes. Full lifecycle: IN_PROGRESS → COMPLETED → TEST_DEPLOYING → TEST_DEPLOYED (for test deployments) or IN_PROGRESS → COMPLETED → PENDING_PEER_REVIEW → PEER_APPROVED → PENDING_ADMIN_REVIEW → ADMIN_APPROVED → DEPLOYED (for production deployments). Rejection branches: PENDING_PEER_REVIEW → PEER_REJECTED, PENDING_ADMIN_REVIEW → ADMIN_REJECTED. Withdrawal branches: PENDING_PEER_REVIEW → WITHDRAWN, PENDING_ADMIN_REVIEW → WITHDRAWN.",
      "required": true,
      "matchField": false
    },
    {
      "name": "componentsTotal",
      "type": "Number",
      "description": "Total number of components in dependency tree",
      "required": true,
      "matchField": false
    },
    {
      "name": "componentsCreated",
      "type": "Number",
      "description": "Number of new components created in production",
      "required": true,
      "matchField": false
    },
    {
      "name": "componentsUpdated",
      "type": "Number",
      "description": "Number of existing production components updated",
      "required": true,
      "matchField": false
    },
    {
      "name": "componentsFailed",
      "type": "Number",
      "description": "Number of components that failed to promote",
      "required": true,
      "matchField": false
    },
    {
      "name": "errorMessage",
      "type": "String",
      "description": "Error details if promotion failed (up to 5000 characters)",
      "required": false,
      "matchField": false
    },
    {
      "name": "resultDetail",
      "type": "String",
      "description": "JSON string with per-component results and metadata (up to 5000 characters)",
      "required": false,
      "matchField": false
    },
    {
      "name": "peerReviewStatus",
      "type": "String",
      "description": "Peer review gate status: PENDING_PEER_REVIEW, PEER_APPROVED, or PEER_REJECTED",
      "required": false,
      "matchField": false
    },
    {
      "name": "peerReviewedBy",
      "type": "String",
      "description": "Email of the peer reviewer who approved or rejected",
      "required": false,
      "matchField": false
    },
    {
      "name": "peerReviewedAt",
      "type": "Date",
      "description": "Timestamp when peer review action was taken (format: yyyy-MM-dd'T'HH:mm:ss.SSS'Z')",
      "required": false,
      "matchField": false
    },
    {
      "name": "peerReviewComments",
      "type": "String",
      "description": "Peer reviewer comments (up to 500 characters)",
      "required": false,
      "matchField": false
    },
    {
      "name": "adminReviewStatus",
      "type": "String",
      "description": "Admin review gate status: PENDING_ADMIN_REVIEW, ADMIN_APPROVED, or ADMIN_REJECTED",
      "required": false,
      "matchField": false
    },
    {
      "name": "adminApprovedBy",
      "type": "String",
      "description": "Email of the admin who approved or rejected",
      "required": false,
      "matchField": false
    },
    {
      "name": "adminApprovedAt",
      "type": "Date",
      "description": "Timestamp when admin review action was taken (format: yyyy-MM-dd'T'HH:mm:ss.SSS'Z')",
      "required": false,
      "matchField": false
    },
    {
      "name": "adminComments",
      "type": "String",
      "description": "Admin reviewer comments (up to 500 characters)",
      "required": false,
      "matchField": false
    },
    {
      "name": "branchId",
      "type": "String",
      "description": "Promotion branch ID — set on branch creation, cleared (null) after branch cleanup on any terminal path (approve, reject, deny)",
      "required": false,
      "matchField": false
    },
    {
      "name": "branchName",
      "type": "String",
      "description": "Promotion branch name (e.g., promo-{promotionId})",
      "required": false,
      "matchField": false
    },
    {
      "name": "integrationPackId",
      "type": "String",
      "description": "Integration Pack ID — populated after successful deploy (Process D)",
      "required": false,
      "matchField": false
    },
    {
      "name": "integrationPackName",
      "type": "String",
      "description": "Human-readable Integration Pack name — populated after successful deploy",
      "required": false,
      "matchField": false
    },
    {
      "name": "processName",
      "type": "String",
      "description": "Root process name — used for Integration Pack suggestions on future promotions of the same process",
      "required": false,
      "matchField": false
    },
    {
      "name": "targetEnvironment",
      "type": "String",
      "description": "Target deployment environment: TEST or PRODUCTION",
      "required": true,
      "matchField": false
    },
    {
      "name": "isHotfix",
      "type": "String",
      "description": "'true' or 'false' — flags emergency production bypass that skips test environment",
      "required": false,
      "matchField": false
    },
    {
      "name": "hotfixJustification",
      "type": "String",
      "description": "Required when isHotfix='true'. Freetext justification for emergency bypass (up to 1000 characters)",
      "required": false,
      "matchField": false
    },
    {
      "name": "testPromotionId",
      "type": "String",
      "description": "On PRODUCTION records: links back to the TEST promotion that preceded it. Null for direct-to-production hotfixes and for TEST records themselves",
      "required": false,
      "matchField": false
    },
    {
      "name": "testDeployedAt",
      "type": "Date",
      "description": "When test deployment completed (format: yyyy-MM-dd'T'HH:mm:ss.SSS'Z')",
      "required": false,
      "matchField": false
    },
    {
      "name": "testIntegrationPackId",
      "type": "String",
      "description": "Test Integration Pack ID — populated after successful test deployment",
      "required": false,
      "matchField": false
    },
    {
      "name": "testIntegrationPackName",
      "type": "String",
      "description": "Human-readable Test Integration Pack name — populated after successful test deployment",
      "required": false,
      "matchField": false
    },
    {
      "name": "promotedFromTestBy",
      "type": "String",
      "description": "SSO user email who initiated the test→production promotion",
      "required": false,
      "matchField": false
    },
    {
      "name": "withdrawnAt",
      "type": "Date",
      "description": "Timestamp when the promotion was withdrawn by the initiator (format: yyyy-MM-dd'T'HH:mm:ss.SSS'Z')",
      "required": false,
      "matchField": false
    },
    {
      "name": "withdrawalReason",
      "type": "String",
      "description": "Optional reason for withdrawal provided by the initiator (up to 500 characters)",
      "required": false,
      "matchField": false
    }
  ],
  "matchRules": [
    {
      "type": "EXACT",
      "description": "Match on promotion ID (each promotion run is unique)",
      "fields": ["promotionId"]
    }
  ],
  "sources": [
    {
      "name": "PROMOTION_ENGINE",
      "type": "contribute-only",
      "description": "Written by promotion engine at start (IN_PROGRESS), updated at completion by Process C with exactly COMPLETED or FAILED (the only two terminal statuses from Process C — fail-fast policy guarantees no partial state), updated during test deployment lifecycle (TEST_DEPLOYING/TEST_DEPLOYED/TEST_DEPLOY_FAILED), and updated by peer review (Process E2) and admin review (Process E3) during the 2-layer approval workflow, and updated by Process E5 on withdrawal (status=WITHDRAWN, branchId cleared, withdrawnAt/withdrawalReason set)"
    }
  ],
  "dataQualitySteps": [],
  "notes": "This model provides complete audit trail for compliance and troubleshooting. The promotion engine creates a record at the start of each promotion (status=IN_PROGRESS) and updates it when complete. For test deployments (targetEnvironment=TEST), the record transitions through TEST_DEPLOYING → TEST_DEPLOYED and the branch is preserved for future production review. For production deployments, the record enters a 2-layer approval workflow: peer review (peerReviewStatus) followed by admin review (adminReviewStatus). Emergency hotfixes (isHotfix=true) go directly to production with full reviews but skip the test-first requirement — hotfixJustification is required. When a test deployment is promoted to production, the new PRODUCTION record links back via testPromotionId. Self-review prevention is enforced at the backend level (reviewer cannot equal initiatedBy). The resultDetail field stores structured JSON for detailed analysis of individual component outcomes. The branchId field tracks the Boomi Branching promotion branch lifecycle — set on creation, cleared after cleanup (note: for test deployments, the branch persists through the test→production lifecycle for diff/audit purposes). Contributors can withdraw their own promotions while in PENDING_PEER_REVIEW or PENDING_ADMIN_REVIEW status via Process E5 — the branch is deleted, status set to WITHDRAWN, and withdrawnAt/withdrawalReason recorded. The processName and integrationPackId fields enable smart Integration Pack suggestions for repeat promotions."
}
